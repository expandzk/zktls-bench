<!doctype html>

<html>

<head>
  <meta charset="utf-8">
  <title>Pado Wasm</title>
  <style>
      #output {
        width: 100%;
        height: 600px;
        margin: 0 auto;
        margin-top: 10px;
        border-left: 0px;
        border-right: 0px;
        padding-left: 0px;
        padding-right: 0px;
        display: block;
        background-color: black;
        color: white;
        font-family: 'Lucida Console', Monaco, monospace;
        outline: none;
      }
  </style>
</head>

<body>
  <textarea id="output" rows="8"></textarea>
  <script>
     function call(params) {
         console.log("call with params:", params);
         return "{}";
     }
      var Module = {
        preRun: [],
        postRun: [],
        print: (function() {
          var element = document.getElementById('output');
          if (element) element.value = ''; // clear browser cache
          return function(text) {
            if (arguments.length > 1) text = Array.prototype.slice.call(arguments).join(' ');
            // These replacements are necessary if you render to raw HTML
            //text = text.replace(/&/g, "&amp;");
            //text = text.replace(/</g, "&lt;");
            //text = text.replace(/>/g, "&gt;");
            //text = text.replace('\n', '<br>', 'g');
            console.log(text);
            if (element) {
              element.value += text + "\n";
              element.scrollTop = element.scrollHeight; // focus on bottom
            }
          };
        })()
      };
      var call_client = null;
      Module.onRuntimeInitialized = function() {
          call_client = Module.cwrap("_main", "string", ["string"]);
              output.value = "";
			  let param = {
				  "program": "test_protocol",
				  "party": "1",
				  "ip": "127.0.0.1",
				  "port": "12345",
				  "requestSize": "1024",
				  "responseSize": "16"
			  };
			  let paramstr = JSON.stringify(param);

              var result = call_client(paramstr);
      };

  </script>
  <script src="zktls_bench.js"></script>
</body>

</html>
